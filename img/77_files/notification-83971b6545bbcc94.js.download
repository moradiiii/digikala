(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1909],{83514:function(t,i,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/notification",function(){return e(26919)}])},26919:function(t,i,e){"use strict";e.r(i),e.d(i,{default:function(){return is}});var n=e(2784),o=e(66383),a=e(52322),s=e(70423),c=e(5632),r=e(72610),l=e(27876),d=e(41218),u=e(88589),f=e(64665),m=e(45873),p=e(11559),x=e(72873),g=e(64177),T=e(53828),N=e(87049),v=e(8108),h=e(43287);function b(t){var i=t.widgetName,e=t.itemClickedName;(0,v.N)({name:"widget_click",body:{version:2,page_type:(0,h.C)(),widget_name:i,clicked_item_name:e}})}function C(t){b({widgetName:"first_open_notification",itemClickedName:t.notificationId})}function j(t){b({widgetName:"reopen_notification",itemClickedName:t.notificationId})}function I(t){b({widgetName:"read_all",itemClickedName:t.unreadNotificationCount})}function E(t){var i,e,n;e=(i={itemClickedName:t.tabTitle,widgetName:"notification_center_tabs"}).widgetName,n=i.itemClickedName,(0,v.N)({name:"widget_click",body:{version:2,page_type:(0,h.C)(),widget_name:e,clicked_item_name:n}})}var A=e(80786),_=e(6013),y=e(99125),O=e(42306),S=e(4818),k=e(41435),w=e(17156),R=e(82650),P=e(94042),M=e(52216),L=e(70582),D={SEEN:"SEEN",NOT_SEEN:"NOT_SEEN"},Y={seen:D.SEEN,not_seen:D.NOT_SEEN},U=e(79968),G=e(46932),F=e(1324),B=(0,F.q)({url:"profile/notifications/",transformer:function(t){var i=t.data||{},e=i.notifications,n=i.alert,o=i.pager;return{notifications:(null==e?void 0:e.map(function(t){var i,e,n,o,a,s,c,r,l,d,u,f,m,p,x,g,T,N,v,h,b,C,j,I,E,A;return m=(f=t||{}).id,p=f.title,x=f.message,g=f.images,T=f.date,N=f.url,v=f.main_image,h=f.status,b=f.type,C=f.icon,j=f.action,I=f.expiration_text,E=f.is_expired,A=f.magnet_meta_data,{notificationId:m,notificationType:b,notificationTitle:(0,M.U)(p),notificationMessage:(0,M.U)(x),notificationDate:(0,M.U)(T),notificationMainImage:(0,L.W)({data:v}),notificationImages:(null==g?void 0:null===(u=g.map)||void 0===u?void 0:u.call(g,function(t){return(0,L.W)({data:t})}))||[],notificationStatus:Y[h],notificationAction:!(0,k.x)(j)&&{notificationActionTitle:(i=j||{}).action_title,notificationActionValue:i.action_value,notificationActionType:i.action_type},notificationUrl:(0,U.f)({data:N}),notificationIcon:(n=(e=C||{}).image,o=e.background_color,{notificationIconUrl:(0,L.W)({data:n}),notificationIconBackgroundColor:o}),notificationIsExpired:E,notificationExpirationText:(0,M.U)(I),notificationMagnetData:(s=(a=A||{}).to_follow,c=a.name,r=a.username,l=a.bio,d=a.mentioned_comment_id,{notificationMagnetToFollow:s,notificationMagnetType:a.type,notificationMagnetName:c,notificationMagnetBio:(0,M.U)(l),notificationMagnetUsername:r,notificationMagnetMentionedCommentId:d})}}))||[],pinNotification:n,pager:(0,G.d)({data:o})}}}),q=e(45227),z=e(8398),Z=(0,F.q)({url:"/notification/seen/",type:q.XN.POST,inputTransformer:z.d}),K=e(31909),H=e(72677);function X(t){var i=t.className;return(0,a.jsxs)("div",{"data-testid":"profile-notifications-empty-state",className:(0,H.d)("bg-neutral-000 flex flex-col items-center justify-center h-full mx-2 py-18 lg:pt-20 lg:pb-30 user-select-none",i),children:[(0,a.jsx)(K.E,{width:256,height:192,alt:"Empty Notification",src:"/statics/img/svg/profile/empty-notification.svg"}),(0,a.jsx)("div",{className:"mt-3 text-h5 text-neutral-800",children:"هنوز که خبری نیست..."}),(0,a.jsx)("div",{className:"text-body-1 text-neutral-600",children:"پیام‌ها و خبرها را اینجا نمایش خواهیم داد"})]})}function W(t){var i=t.notificationAction||{},e=i.notificationActionTitle,n=i.notificationActionValue;return(0,a.jsxs)("div",{"data-testid":"notification-action-badge",className:"flex items-center gap-1 bg-neutral-100 h-6 rounded-medium-plus px-2",children:[(0,a.jsxs)("p",{className:"text-body-2",children:[e,":"]}),(0,a.jsx)("p",{className:"text-body2-strong tracking-[4px]",children:n})]})}var J=e(98723);function V(t){var i=t.className,e=t.text,n=t.onClick,o=t.to,s=t.pending,c=t.color,l=t.isDisabled;return(0,a.jsx)(J.r,{"data-testid":"notification-action-button",className:(0,H.d)("h-8 flex justify-center items-center text-body2-strong whitespace-nowrap rounded-large px-3 py-1 grow-0 border-[1px] border-solid",i,"high-emphasis"===(void 0===c?"high-emphasis":c)?"text-neutral-650 border-neutral-650":"text-dark-neutral-500 border-dark-neutral-500"),to:o,disabled:l,onClick:!l&&n,children:s?(0,a.jsx)(r.g,{"data-testid":"loading",size:20}):e})}var Q=e(36696),$=e(75490),tt=e(47842),ti=e(27314),te=e(58449),tn=(0,F.q)({url:function(t){var i=t.notificationId;return"/notification/".concat(i,"/click/")},type:q.XN.POST,inputTransformer:function(t){return{notificationId:t.notificationId}}}),to=(0,F.q)({type:q.XN.POST,url:function(t){var i=t.notificationId;return"notification/".concat(i,"/seen/")}}),ta=e(18814),ts=e.n(ta),tc={mobile:36,desktop:44};function tr(t){var i=t.notification,e=t.leftSlot,n=t.bottomSlot,o=t.isLeftSlotCenter,s=i||{},c=s.notificationId,r=s.notificationUrl,l=s.notificationIcon,d=s.notificationTitle,u=s.notificationDate,f=s.notificationMessage,m=s.notificationStatus,x=s.notificationExpirationText,v=s.notificationIsExpired,h=(0,ti.e)().redirect,b=(0,T.I)(),I=(0,N.v)(_.p.notificationCount),E=(0,g.C)().isDesktop,A=(0,p.E)({apiMethod:to}).request,O=(0,p.E)({apiMethod:tn}).request;if((0,k.x)(i))return null;var S=(0,te.k)(f);return(0,a.jsx)("div",{"data-testid":"notification-base-card",className:(0,H.d)("relative py-3 px-4 cursor-pointer",(0,tt.Z)({},ts().NotificationBaseCard__background,m===D.NOT_SEEN)),onClick:v?function(){(0,$.p)({message:x||"این پیام منقضی شده است."})}:function(){h({url:r}),O({notificationId:c}),m===D.NOT_SEEN?(C({notificationId:c}),A({notificationId:c}),b((0,y.d2)(I-1))):j({notificationId:c})},children:(0,a.jsxs)("div",{className:(0,H.d)("z-2 flex gap-2 justify-between text-neutral-900",{"items-center":S||o,"opacity-[50%]":v}),children:[(0,a.jsxs)("div",{className:(0,H.d)("flex gap-3",{"w-full":!e}),children:[(0,a.jsx)(K.E,{className:"shrink-0",imageClassName:"rounded-circle",height:E?tc.desktop:tc.mobile,width:E?tc.desktop:tc.mobile,src:"/statics/img/svg/profile/notification-default-placeholder.svg",image:null==l?void 0:l.notificationIconUrl}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("p",{className:"text-body2-strong",children:d}),!S&&(0,a.jsx)("p",{className:"text-body-2 text-neutral-600",children:f}),n,(0,a.jsx)("p",{className:"text-caption-compact text-neutral-500 mt-1",children:(0,M.U)(u)})]})]}),e?(0,a.jsx)("div",{children:e}):null]})})}function tl(t){var i=t.notification,e=i||{},n=e.notificationAction,s=e.notificationIsExpired,c=(0,o.Z)((0,Q.m)(),2),r=(c[0],c[1]),l=(n||{}).notificationActionValue;return(0,a.jsx)(tr,{notification:i,bottomSlot:(0,a.jsxs)("div",{className:"flex justify-between items-center py-3",children:[(0,a.jsx)(W,{notificationAction:n}),(0,a.jsx)(V,{className:"cursor-copy",text:"کپی‌کردن کد",onClick:function(t){t.stopPropagation(),r(l),(0,$.p)({message:"کد کپی شد"})},isDisabled:s})]})})}var td={INFORM:"inform",INFORM_ACTION:"inform_action",INFORM_ACTION_IMAGES:"inform_action_images",INFORM_ACTION_COPY:"inform_action_copy",MAGNET:"magnet"},tu={mobile:32,desktop:40},tf={mobile:3,desktop:6};function tm(t){var i=t.notificationImages,e=void 0===i?[]:i,o=(0,g.C)().isDesktop,s=o?tf.desktop:tf.mobile,c=e.length-s,r=(0,n.useMemo)(function(){return e.slice(0,s)},[e,s]),l=o?tu.desktop:tu.mobile;return(0,k.x)(e)?null:(0,a.jsxs)("div",{className:"flex gap-1","data-testid":"profile-notification-images",children:[r.map(function(t){return(0,a.jsx)(K.E,{imageClassName:"rounded border-complete",image:t,height:l,width:l})}),c>0&&(0,a.jsxs)("div",{style:{height:l,width:l},className:"flex items-center justify-center text-body-2 bg-app-background-mid-dark rounded border-complete",children:[(0,M.U)(c),"+"]})]})}var tp={LINK:"link",COPY:"copy","NONE-COPY":"none-copy"};function tx(t){var i=t.notification,e=i||{},n=e.notificationUrl,o=e.notificationAction,s=e.notificationImages,c=e.notificationIsExpired,r=!(0,k.x)(o),l=(null==o?void 0:o.notificationActionType)===tp.LINK?(0,a.jsx)(V,{text:o.notificationActionTitle,to:n,isDisabled:c}):(0,a.jsx)(W,{notificationAction:o});return(0,a.jsx)(tr,{notification:i,bottomSlot:(0,a.jsxs)("div",{className:(0,H.d)("py-3 flex items-center",(0,k.x)(s)?"justify-end":"justify-between"),children:[(0,a.jsx)(tm,{notificationImages:s||[]}),r?l:null]})})}function tg(t){var i=t.notification,e=i||{},n=e.notificationAction,o=e.notificationUrl,s=e.notificationIsExpired,c=n||{},r=c.notificationActionTitle,l=c.notificationActionType;return(0,a.jsx)(tr,{notification:i,leftSlot:l===tp.LINK?(0,a.jsx)(V,{to:o,text:r,isDisabled:s}):(0,a.jsx)(W,{notificationAction:n})})}var tT={mobile:44,desktop:56};function tN(t){var i=t.notification,e=(i||{}).notificationMainImage,n=(0,g.C)().isDesktop;return(0,a.jsx)(tr,{isLeftSlotCenter:!0,leftSlot:(0,k.x)(e)?null:(0,a.jsx)(K.E,{"data-testid":"notification-inform-card-image",imageClassName:"rounded",image:e,height:n?tT.desktop:tT.mobile,width:n?tT.desktop:tT.mobile}),notification:i})}var tv={MAGNET_LIKE_CONTENT:"magnet_like_content",MAGNET_FOLLOW:"magnet_follow",MAGNET_COMMENT_CREATED:"magnet_comment_created",MAGNET_MENTIONED:"magnet_mentioned"},th=e(98780),tb=e(74136),tC=e(18577),tj=e(71390),tI=e(19436),tE=e.n(tI),tA={mobile:36,desktop:44};function t_(t){var i=t.notification,e=t.leftSlot,n=(0,ti.e)().redirect,o=(0,g.C)().isDesktop,s=(0,T.I)(),c=(0,N.v)(_.p.notificationCount),r=i.notificationId,l=i.notificationUrl,d=i.notificationIcon,u=i.notificationTitle,f=i.notificationDate,m=i.notificationMessage,x=i.notificationStatus,v=i.notificationIsExpired,h=i.notificationExpirationText,b=(0,p.E)({apiMethod:to}).request,I=(0,p.E)({apiMethod:tn}).request,E=(0,te.k)(m);return(0,tC.xb)(i)?null:(0,a.jsx)("div",{className:(0,tC.dh)("relative py-3 px-4 cursor-pointer",(0,tt.Z)({},tE().NotificationMagnetBaseCard__background,x===D.NOT_SEEN)),children:(0,a.jsxs)("div",{className:(0,tC.dh)("z-2 flex gap-2 justify-between text-neutral-900 items-center",{"opacity-[50%]":v}),onClick:v?function(){(0,$.p)({message:h||"این پیام منقضی شده است."})}:function(){n({url:l}),I({notificationId:r}),x===D.NOT_SEEN?(C({notificationId:r}),b({notificationId:r}),s((0,y.d2)(c-1))):j({notificationId:r})},children:[(0,a.jsxs)("div",{className:(0,tC.dh)("flex gap-3",{"w-full":!e}),children:[(0,a.jsx)(K.E,{className:"shrink-0",imageClassName:"rounded-circle",height:o?tA.desktop:tA.mobile,width:o?tA.desktop:tA.mobile,src:tj.C,image:null==d?void 0:d.notificationIconUrl}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("p",{className:"text-body2-strong",children:u}),!E&&(0,a.jsx)("p",{className:"text-body-2 text-neutral-600",children:m}),(0,a.jsx)("p",{className:"text-caption-compact text-neutral-500 mt-1",children:(0,tC.Uu)(f)})]})]}),e?(0,a.jsx)("div",{children:e}):null]})})}function ty(t){var i=t.notification,e=i||{},n=e.notificationMagnetData,o=e.notificationIsExpired,s=n||{},c=s.notificationMagnetToFollow,r=s.notificationMagnetUsername,l=(0,tb.l)({isFollowing:!c,username:r}),d=l.onFollowStateChangeAction,u=l.isFollowing,f=l.pending;return(0,a.jsx)(t_,{notification:i,leftSlot:(0,a.jsx)(V,{className:(0,H.d)("w-22 lg:w-24 cursor-pointer",u&&"border-none"),onClick:function(t){t.preventDefault(),t.stopPropagation(),d()},text:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(th.J,{icon:u?"cube-content-check":"cube-action-add-person",size:20,color:"high-emphasis"}),(0,a.jsx)("span",{children:u?"دنبال شده":"دنبالش کن"})]}),color:"high-emphasis",pending:f,isDisabled:o})})}var tO={mobile:44,desktop:56};function tS(t){var i=t.notification,e=(0,g.C)().isDesktop,n=(i||{}).notificationMainImage;return(0,a.jsx)(t_,{notification:i,leftSlot:!(0,k.x)(n)&&(0,a.jsx)(K.E,{imageClassName:"rounded",image:n,height:e?tO.desktop:tO.mobile,width:e?tO.desktop:tO.mobile})})}function tk(t){var i=t.notification;return(0,k.x)(i)?null:i.notificationMagnetData.notificationMagnetType===tv.MAGNET_FOLLOW?(0,a.jsx)(ty,{notification:i}):(0,a.jsx)(tS,{notification:i})}function tw(t){var i=t.notification;if((0,k.x)(i))return null;switch(i.notificationType){case td.INFORM_ACTION:return(0,a.jsx)(tg,{notification:i});case td.INFORM_ACTION_IMAGES:return(0,a.jsx)(tx,{notification:i});case td.INFORM_ACTION_COPY:return(0,a.jsx)(tl,{notification:i});case td.MAGNET:return(0,a.jsx)(tk,{notification:i});default:return(0,a.jsx)(tN,{notification:i})}}function tR(t){var i=t.className,e=t.notifications;return(0,a.jsx)("div",{"data-testid":"profile-notifications-list",className:(0,H.d)("bg-neutral-000",i),children:null==e?void 0:e.map(function(t){return(0,a.jsx)(tw,{notification:t},t.notificationId)})})}var tP=e(28219),tM=e.n(tP);function tL(t){var i=t.className,e=t.pinNotification;return e?(0,a.jsxs)("div",{"data-testid":"profile-notifications-pin",className:(0,H.d)(i,tM().bg,"py-2 lg:py-5 px-4 flex gap-4 items-center"),children:[(0,a.jsx)(th.J,{icon:"infoOutline",color:"high-emphasis"}),(0,a.jsx)("p",{className:"text-body-2",children:e})]}):null}var tD=e(57931);function tY(t){var i=t.className,e=t.shouldShowReadAll,n=t.onReadAll;return e?(0,a.jsx)("div",{"data-testid":"profile-notifications-read-all",className:(0,H.d)("bg-neutral-000 mb-4 lg:mb-0 user-select-none",i),children:(0,a.jsx)(tD.z,{removePadding:!0,shape:"text",color:"black",size:"small",onClick:n,appendIcon:"cube-content-check-double",label:"خواندن همه"})}):null}var tU=e(98634),tG={ALL:{TYPE:"all",ICON:"cube-badge-dk-smile"},ALERT:{TYPE:"alert",ICON:"notificationActiveOutline"},ORDER:{TYPE:"order",ICON:"order"},MARKETING:{TYPE:"marketing",ICON:"promo"},TRANSACTION:{TYPE:"transaction",ICON:"invoice"},MAGNET:{TYPE:"magnet",ICON:"cube-badge-magnet-outline"}},tF=function(t){var i=t.data||{},e=i.title,n=i.color;return{tabNotificationNotSeenCount:i.not_seen_count,tabColor:n,tabTitle:e}},tB=(0,F.q)({url:"profile/notifications/tabs/",transformer:function(t){var i=(t.data||{}).tabs||{},e=i.all,n=i.alert,o=i.order,a=i.marketing,s=i.transaction,c=i.magnet;return{allTab:tF({data:e}),alertTab:tF({data:n}),orderTab:tF({data:o}),marketingTab:tF({data:a}),transactionTab:tF({data:s}),magnetTab:tF({data:c})}}}),tq=e(42090),tz=e.n(tq),tZ=(0,n.memo)(function(t){var i=t.type,e=t.icon,n=t.isActive,o=t.onTabChange,s=t.notificationTab,c=t.isAllRead,r=t.isTabCollapsed,l=(0,g.C)().isDesktop,d=s||{},u=d.tabTitle,m=d.tabNotificationNotSeenCount;if(!u)return null;var p=!c&&m>0&&i!==tG.ALL.TYPE;return(0,a.jsxs)("div",{onClick:function(){o(i)},className:(0,H.d)("ml-2 p-2 text-body2-strong text-neutral-700 cursor-pointer w-18 lg:w-unset","flex flex-col lg:flex-row items-center justify-center border-complete rounded relative",{"bg-dark-neutral-000 text-white":n},!l&&{"h-9":r,"h-16":!r},tz().transition),children:[(0,a.jsx)(th.J,{icon:e,size:20,color:n?"white":"neutral-700",className:(0,H.d)(r?"opacity-0":"opacity-100",tz().transition)}),(0,a.jsx)("p",{className:(0,H.d)("lg:mr-1 mt-1 lg:mt-0 whitespace-nowrap",r&&tz().moveUp),children:u}),!(0,O.d)(f.X.AB_NOTIFICATION_BADGE_TOOLTIP)&&p?(0,a.jsx)(th.J,{className:"lg:static absolute top-0 left-0",icon:"cube-content-dot",size:16,color:n?"white":"primary"}):null]})});function tK(t){var i=t.activeTab,e=void 0===i?"all":i,s=t.onTabChange,c=t.isAllRead,r=t.className,l=(0,n.useRef)(),d=(0,g.C)().isDesktop,u=(0,o.Z)((0,n.useState)(!1),2),f=u[0],m=u[1],p=(0,x.V)({apiMethod:tB}).data,T=p.allTab,N=p.alertTab,v=p.orderTab,h=p.marketingTab,b=p.transactionTab,C=p.magnetTab;return(0,n.useEffect)(function(){var t=(0,tU.P2)(function(){l.current&&!d&&(l.current.getBoundingClientRect().top<=2?m(!0):m(!1))},100);return window.addEventListener("scroll",t),function(){return window.removeEventListener("scroll",t)}},[]),(0,a.jsx)("div",{ref:l,className:(0,H.d)("bg-neutral-000 px-2 lg:px-4 sticky top-0 lg:static z-2 pb-2",r),children:(0,a.jsxs)("div",{className:"flex items-center user-select-none overflow-x-auto hide-scrollbar pt-2 lg:pt-0",children:[(0,a.jsx)(tZ,{type:tG.ALL.TYPE,icon:tG.ALL.ICON,notificationTab:T,isActive:tG.ALL.TYPE===e,onTabChange:s,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tZ,{type:tG.ALERT.TYPE,icon:tG.ALERT.ICON,notificationTab:N,isActive:tG.ALERT.TYPE===e,onTabChange:s,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tZ,{type:tG.ORDER.TYPE,icon:tG.ORDER.ICON,notificationTab:v,isActive:tG.ORDER.TYPE===e,onTabChange:s,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tZ,{type:tG.MARKETING.TYPE,icon:tG.MARKETING.ICON,notificationTab:h,isActive:tG.MARKETING.TYPE===e,onTabChange:s,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tZ,{type:tG.TRANSACTION.TYPE,icon:tG.TRANSACTION.ICON,notificationTab:b,isActive:tG.TRANSACTION.TYPE===e,onTabChange:s,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tZ,{type:tG.MAGNET.TYPE,icon:tG.MAGNET.ICON,notificationTab:C,isActive:tG.MAGNET.TYPE===e,onTabChange:s,isAllRead:c,isTabCollapsed:f})]})})}function tH(){var t,i,e=(0,g.C)().isDesktop,u=(0,T.I)(),m=(0,o.Z)((0,n.useState)(!1),2),v=m[0],h=m[1],b=(0,o.Z)((0,n.useState)(tG.ALL.TYPE),2),C=b[0],j=b[1],A=(0,o.Z)((0,n.useState)(1),2),S=A[0],L=A[1],D=(0,N.v)(_.p.notificationCount),Y=(t=(0,w.NQ)().ready,i=(0,R.z)().emit,{triggerCustomSurvey:function(t){return i(P.y5,t)},isInAppSurveyServiceReady:t}),U=Y.triggerCustomSurvey,G=Y.isInAppSurveyServiceReady,F=(0,x.V)({apiMethod:B,apiData:{type:C,page:S}}),q=F.data,z=F.pending,K=F.reload,H=(0,p.E)({apiMethod:Z,onSuccess:function(){I({unreadNotificationCount:D}),K(),u((0,y.d2)(0)),h(!0)}}).request,W=(0,n.useCallback)(function(t){j(t),E({tabTitle:t}),G&&U("in-app-survey-notification-change-tab")},[G]),J=q||{},V=J.notifications,Q=J.pinNotification,$=J.pager,tt=function(t){s.NY.scrollToTop({duration:100,smooth:!0}),L(t)};(0,n.useEffect)(function(){L(1)},[C]),(0,n.useEffect)(function(){u((0,y.wi)(0))},[]);var ti=(0,n.useMemo)(function(){return z?(0,a.jsx)(r.g,{"data-testid":"profile-notifications-loading",className:"my-50"}):(0,k.x)(V)?(0,a.jsx)(X,{}):(0,a.jsxs)("div",{children:[tG.ALL.TYPE&&(0,a.jsx)(tL,{pinNotification:Q}),(0,a.jsx)(tR,{notifications:V}),(0,a.jsx)(l.t,{pageSize:20,pagerCurrentPage:null==$?void 0:$.pagerCurrentPage,pagerTotalPages:null==$?void 0:$.pagerTotalPages,clickAction:tt})]})},[z,V,C,null==$?void 0:$.pagerCurrentPage]),te=(0,c.useRouter)();return(0,a.jsx)("div",{children:(0,a.jsxs)(d.P,{withTitleLine:e,hasTitleInMobile:!0,shouldShowBack:!0,hasHeaderActionInMobile:!0,onBackClicked:function(){te.back()},title:(0,O.d)(f.X.AB_NOTIFICATION_BADGE_TOOLTIP)?"پیام‌ها":(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{children:"پیام‌ها"}),D?(0,a.jsx)("div",{className:"bg-primary-500 text-caption-compact text-white px-2 rounded-[100px] pt-1 pb-0.5",children:(0,M.U)(D)}):null]}),headerAction:(0,a.jsx)(tY,{className:"lg:mt-0 mt-4",onReadAll:H,shouldShowReadAll:D>0}),children:[(0,a.jsx)(tK,{isAllRead:v,activeTab:C,onTabChange:W}),ti]})})}var tX=e(70865),tW=e(96670),tJ=(0,F.q)({url:"profile/notifications/",transformer:function(t){var i=t.data||{},e=i.notifications,n=i.pager;return{notifications:(null==e?void 0:e.map(function(t){var i,e,n,o,a,s,c,r,l,d,u,f,m,p,x;return o=(n=t||{}).id,a=n.title,s=n.message,c=n.images,r=n.date,l=n.action_title,d=n.icon_color,u=n.url,f=n.icon,m=n.main_image,p=n.status,x=(0,L.W)({data:f,prefix:"notificationIcon"}),(0,tW.Z)((0,tX.Z)({notificationId:o,notificationTitle:null!=a?a:"",notificationMessage:null!=s?s:"",notificationImages:null!==(i=null==c?void 0:c.map(function(t){return(0,L.W)({data:t})}))&&void 0!==i?i:[],notificationStatus:Y[p],notificationDate:null!=r?r:"",notificationActionTitle:null!=l?l:"",notificationIconColor:null!=d?d:"",notificationUrl:null!==(e=(0,U.f)({data:u}))&&void 0!==e?e:"",notificationIcon:(0,L.W)({data:f})},x),{notificationMainImage:(0,L.W)({data:m})})}))||[],pager:(0,G.d)({data:n})}}}),tV=(0,F.q)({url:"/notification/seen/",type:q.XN.POST,inputTransformer:z.d});function tQ(t){var i=t.className,e=t.shouldShowReadAll,n=t.onReadAll;return(0,a.jsx)("div",{className:(0,H.d)("bg-neutral-000 mb-4 lg:mb-0 user-select-none",i),children:e&&(0,a.jsx)(tD.z,{shape:"text",color:"secondary",size:"large",onClick:n,prependIcon:"notificationMarkAsRead",iconColor:"secondary",label:"تغییر پیام‌ها به خوانده شده"})})}function t$(t){var i=t.className;return(0,a.jsxs)("div",{className:(0,H.d)("bg-neutral-000 flex flex-col items-center justify-center mx-2 py-10 lg:pt-20 lg:pb-30 user-select-none",i),children:[(0,a.jsx)(K.E,{width:180,height:135,alt:"Empty Notification",src:"/statics/img/svg/profile/empty-notification.svg"}),(0,a.jsx)("div",{className:"mt-3 text-body-1 text-neutral-900",children:"هنوز پیامی نیومده"})]})}function t0(t){var i=t.className,e=t.images,n=t.imageSize,o=t.imageRadius,s=t.imagesAlt,c=t.imageClassName,r=t.maxToDisplay,l=void 0===r?3:r,d=t.withBorder,u=(0,H.d)("flex flex-row gap-4 sm:text text-neutral-500",{"divide-x divide-x-reverse divide-n-100":void 0!==d&&d},i);return(0,a.jsx)("div",{className:u,children:e.map(function(t,i){return i<l?(0,a.jsx)(K.E,{width:n,height:n,image:t,alt:s,rounded:o,objectFit:"cover",className:c},i):i===l?(0,a.jsx)("div",{className:"flex justify-center items-center pr-6 text-body-1 text-neutral-900",children:"".concat((0,M.U)(e.length-l),"+")},i):null})})}var t2=(0,F.q)({type:q.XN.POST,url:function(t){var i=t.notificationId;return"notification/".concat(i,"/seen/")}}),t1=e(55917),t4=e.n(t1);function t6(t){var i=t.notification,e=t.className,n=(0,g.C)().isDesktop,o=(0,p.E)({apiMethod:t2}).request,s=i.notificationId,c=i.notificationTitle,r=i.notificationMessage,l=i.notificationImages,d=i.notificationUrl,u=i.notificationStatus,f=i.notificationDate,m=i.notificationActionTitle,x=i.notificationIconColor,T=i.notificationIcon,N=i.notificationMainImage,v=function(){if(u!==D.NOT_SEEN){j({notificationId:s});return}o({notificationId:s}).then(function(){C({notificationId:s})})};return(0,a.jsxs)(J.r,{className:(0,H.d)("bg-neutral-000 flex items-start py-4 px-2 lg:px-4 br-list-vertical-no-padding-200",e),to:!n&&d,shouldHandleUrlAndOnClick:!0,onClick:!n&&v,children:[T&&x&&(0,a.jsx)("div",{style:{backgroundColor:x},className:(0,H.d)("flex items-center justify-center ml-4 lg:mr-0 rounded-circle shrink-0",t4().ProfileNotificationsListCard__iconContainer),children:(0,a.jsx)(K.E,{width:16,height:16,image:T,alt:"Notification Icon"})}),(0,a.jsxs)("div",{className:"grow flex flex-col relative",children:[u===D.NOT_SEEN&&(0,a.jsx)("div",{className:(0,H.d)("absolute rounded-circle bg-secondary-500 z-1",t4().ProfileNotificationsListCard__notSeenDot)}),(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-body1-strong text-neutral-700",children:(0,M.U)(c)}),(0,a.jsx)("p",{className:"text-body-2 text-neutral-500 w-full",children:(0,M.U)(r)})]}),!(0,k.x)(N)&&(0,a.jsx)(K.E,{width:60,height:60,image:N,alt:"DK-product-notification",className:"mr-2 min-w-15 min-h-15"})]}),!(0,k.x)(l)&&(0,a.jsx)("div",{className:"mt-3 select-none -mr-8 lg:mr-0",children:(0,a.jsx)(t0,{images:l,withBorder:!n,maxToDisplay:n?7:5,imageSize:n?40:32})}),(0,a.jsxs)("div",{className:"flex items-center flex-row-reverse lg:flex-row justify-between mt-3 user-select-none",children:[d&&(0,a.jsx)("div",{onClick:v,children:(0,a.jsxs)(J.r,{to:d,className:"flex items-center text-button-1 text-secondary-500 cursor-pointer",children:[(0,a.jsx)("div",{className:"sm:text",children:m}),(0,a.jsx)(th.J,{icon:"chevronLeft",size:18,color:"secondary",className:"mr-1"})]})}),(0,a.jsx)("div",{className:"text-neutral-500 xs:text lg:text-xxs",children:(0,M.U)(f)})]})]})]})}function t3(t){var i=t.className,e=t.notifications;return(0,a.jsx)("div",{className:(0,H.d)("bg-neutral-000 mb-6 px-2 lg:px-4",i),children:null==e?void 0:e.map(function(t){return(0,a.jsx)(t6,{notification:t},t.notificationId)})})}var t5=e(74782);function t8(){return(0,a.jsxs)(t5.ZP,{speed:2,viewBox:"0 0 320 66",backgroundColor:"#f3f3f3",foregroundColor:"#ecebeb",className:"m-auto w-full h-full",children:[(0,a.jsx)("circle",{cx:"300",cy:"20",r:"8"}),(0,a.jsx)("rect",{x:"146",y:"14",rx:"4",ry:"4",width:"140",height:"10"}),(0,a.jsx)("rect",{x:"16",y:"30",rx:"4",ry:"4",width:"270",height:"20"}),(0,a.jsx)("rect",{x:"16",y:"55",rx:"4",ry:"4",width:"270",height:"10"})]})}function t7(t){var i=t.className;return(0,a.jsxs)("div",{className:(0,H.d)("bg-neutral-000 flex flex-col items-center justify-center mx-2 lg:mx-0 mb-10 user-select-none",i),children:[(0,a.jsx)(t8,{}),(0,a.jsx)(t8,{}),(0,a.jsx)(t8,{})]})}var t9={ALL:{TYPE:"all",ICON:""},ALERT:{TYPE:"alert",ICON:"notificationActiveOutline"},ORDER:{TYPE:"order",ICON:"order"},MARKETING:{TYPE:"marketing",ICON:"promo"},TRANSACTION:{TYPE:"transaction",ICON:"invoice"}},it=function(t){var i=t.data||{},e=i.title;return{tabNotificationCount:i.count,tabColor:i.color,tabTitle:e}},ii=(0,F.q)({url:"profile/notifications/tabs/",transformer:function(t){var i=(t.data||{}).tabs||{},e=i.all,n=i.alert,o=i.order,a=i.marketing,s=i.transaction;return{notificationTabsAllCount:null==e?void 0:e.count,notificationTabsAllTitle:null==e?void 0:e.title,notificationTabsAllColor:null==e?void 0:e.color,notificationTabsAlertCount:null==n?void 0:n.count,notificationTabsAlertTitle:null==n?void 0:n.title,notificationTabsAlertColor:null==n?void 0:n.color,notificationTabsOrderCount:null==o?void 0:o.count,notificationTabsOrderTitle:null==o?void 0:o.title,notificationTabsOrderColor:null==o?void 0:o.color,notificationTabsMarketingCount:null==a?void 0:a.count,notificationTabsMarketingTitle:null==a?void 0:a.title,notificationTabsMarketingColor:null==a?void 0:a.color,notificationTabsTransactionCount:null==s?void 0:s.count,notificationTabsTransactionTitle:null==s?void 0:s.title,notificationTabsTransactionColor:null==s?void 0:s.color,allTab:it({data:e}),alertTab:it({data:n}),orderTab:it({data:o}),marketingTab:it({data:a}),transactionTab:it({data:s})}}});function ie(t){var i=t.type,e=t.icon,n=t.isActive,o=t.onTabChange,s=t.notificationTab||{},c=s.tabColor,r=s.tabTitle;return r?(0,a.jsxs)(J.r,{onClick:function(){o(i)},className:(0,H.d)("flex items-center text-caption rounded-large py-1 px-3 ml-2 whitespace-nowrap cursor-pointer border-complete-200 text-neutral-700"),style:n?{borderColor:c,color:c}:null,CROId:"profile-messeges-menu",children:[!!e&&(0,a.jsx)(th.J,{icon:e,size:16,color:n&&c,className:"ml-1"}),r]}):null}function io(t){var i=t.activeTab,e=void 0===i?"all":i,n=t.onTabChange,o=t.className,s=(0,x.V)({apiMethod:ii}).data,c=s.allTab,r=s.alertTab,l=s.orderTab,d=s.marketingTab,u=s.transactionTab;return(0,a.jsx)("div",{className:(0,H.d)("bg-neutral-000 px-2 lg:px-4",o),children:(0,a.jsxs)("div",{className:"flex items-center user-select-none overflow-x-auto hide-scrollbar py-4 lg:py-0",children:[(0,a.jsx)(ie,{type:t9.ALL.TYPE,icon:t9.ALL.ICON,notificationTab:c,isActive:t9.ALL.TYPE===e,onTabChange:n}),(0,a.jsx)(ie,{type:t9.ALERT.TYPE,icon:t9.ALERT.ICON,notificationTab:r,isActive:t9.ALERT.TYPE===e,onTabChange:n}),(0,a.jsx)(ie,{type:t9.ORDER.TYPE,icon:t9.ORDER.ICON,notificationTab:l,isActive:t9.ORDER.TYPE===e,onTabChange:n}),(0,a.jsx)(ie,{type:t9.MARKETING.TYPE,icon:t9.MARKETING.ICON,notificationTab:d,isActive:t9.MARKETING.TYPE===e,onTabChange:n}),(0,a.jsx)(ie,{type:t9.TRANSACTION.TYPE,icon:t9.TRANSACTION.ICON,notificationTab:u,isActive:t9.TRANSACTION.TYPE===e,onTabChange:n})]})})}function ia(){var t=(0,T.I)(),i=(0,g.C)().isDesktop,e=(0,o.Z)((0,n.useState)(t9.ALL.TYPE),2),r=e[0],u=e[1],f=(0,o.Z)((0,n.useState)(1),2),m=f[0],v=f[1],h=(0,N.v)(_.p.notificationCount),b=(0,x.V)({apiMethod:tJ,apiData:{type:r,page:m}}),C=b.data,j=b.pending,A=b.reload,O=(0,p.E)({apiMethod:tV,onSuccess:function(){I({unreadNotificationCount:h}),A(),t((0,y.d2)(0))}}).request,S=C||{},w=S.notifications,R=S.pager,P=function(t){s.NY.scrollToTop({duration:100,smooth:!0}),v(t)};(0,n.useEffect)(function(){v(1)},[r]);var M=(0,n.useMemo)(function(){return j?(0,a.jsx)(t7,{}):(0,k.x)(w)?(0,a.jsx)(t$,{}):(0,a.jsxs)("div",{children:[(0,a.jsx)(t3,{notifications:w}),(0,a.jsx)(l.t,{pageSize:20,pagerCurrentPage:null==R?void 0:R.pagerCurrentPage,pagerTotalPages:null==R?void 0:R.pagerTotalPages,clickAction:P})]})},[j,w,r,null==R?void 0:R.pagerCurrentPage]),L=(0,c.useRouter)();return(0,a.jsxs)("div",{children:[(0,a.jsx)(d.P,{onBackClicked:function(){L.back()},title:"پیغام‌ها",withTitleLine:!1,isMobileHeaderCard:!0}),(0,a.jsxs)(d.P,{isDesktopHeader:!0,title:"پیغام‌ها",withTitleLine:!0,hasWhiteBackground:!1,headerAction:(0,a.jsx)(tQ,{shouldShowReadAll:h>0,onReadAll:O}),children:[!i&&(0,a.jsx)(tQ,{shouldShowReadAll:h>0,onReadAll:O}),(0,a.jsx)(io,{activeTab:r,onTabChange:function(t){u(t),E({tabTitle:t})}}),M]})]})}var is=(0,S.D)({component:function(){return(0,N.v)(A.b.isPendingInit)?(0,a.jsx)(r.g,{className:"my-25"}):(0,O.d)(f.X.NOTIFICATION_CENTER_REDESIGN)?(0,a.jsx)(tH,{}):(0,a.jsx)(ia,{})},layoutProps:{type:u.B.PROFILE,sidebarMenuActiveKey:m.g.NOTIFICATIONS,chatKey:"profile"},isPrivate:!0})},16648:function(t,i,e){"use strict";e.d(i,{R:function(){return s}});var n=e(70865),o=e(52322),a=e(89040);function s(t){return(0,o.jsx)(a.R,(0,n.Z)({},t))}},27876:function(t,i,e){"use strict";e.d(i,{t:function(){return c}});var n=e(70865),o=e(52322),a=e(63222),s=e(27314);function c(t){var i=(0,s.e)().redirect;return(0,o.jsx)(a.t,(0,n.Z)({redirect:i},t))}},41218:function(t,i,e){"use strict";e.d(i,{P:function(){return m}});var n=e(47842),o=e(52322),a=e(16648),s=e(47072),c=e(26442),r=e(64177),l=e(27314),d=e(72677),u=e(33256),f=e.n(u);function m(t){var i=t.children,e=t.className,u=t.title,m=t.headerAction,p=void 0===m?null:m,x=t.withTitleLine,g=t.hideLineInSmallScreen,T=t.hasWhiteBackground,N=t.isMobileHeaderCard,v=t.isDesktopHeader,h=t.hasHeaderActionInMobile,b=t.hasTitleInMobile,C=t.shouldShowBack,j=void 0!==C&&C,I=t.onBackClicked,E=(0,l.e)().redirect,A=(0,r.C)().isDesktop,_=(0,d.d)("mb-4",{"bg-neutral-000":void 0===T||T},e),y=(0,d.d)((0,n.Z)({},f()["ProfileCard__title--mobileHeader"],N));if(N&&A)return null;var O=!!u&&(A&&v||b||N),S=!!p&&(A||h),k=(0,d.d)("flex justify-between items-center lg:py-4 px-4",{"lg:pl-6 lg:pr-4":j});return(0,o.jsxs)(a.R,{className:_,children:[(O||S)&&(0,o.jsxs)("div",{className:k,children:[O&&(0,o.jsx)(s.D,{title:u,withLine:void 0===x||x,className:y,hideLineInSmallScreen:g,rightIcon:!A&&N||j?"arrowRight":null,rightIconOnClick:I||function(){E({url:c._2})}}),S&&p]}),void 0===i?null:i]})}},45873:function(t,i,e){"use strict";e.d(i,{g:function(){return n}});var n={DIGIPLUS:"DIGIPLUS",DASHBOARD:"DASHBOARD",ORDERS:"ORDERS",LISTS:"LISTS",COMMENTS:"COMMENTS",ADDRESSES:"ADDRESSES",GIFT_CARDS:"GIFT_CARDS",NOTIFICATIONS:"NOTIFICATIONS",USER_HISTORY:"USER_HISTORY",USER_INFO:"USER_INFO",LOGOUT:"LOGOUT"}},74136:function(t,i,e){"use strict";e.d(i,{l:function(){return u}});var n=e(66383),o=e(2784),a=e(45227),s=e(1324),c=(0,s.q)({url:function(t){var i=t.username;return"magnet/users/".concat(i,"/follow/")},type:a.XN.POST}),r=(0,s.q)({url:function(t){var i=t.username;return"magnet/users/".concat(i,"/unfollow/")},type:a.XN.POST}),l=e(98634),d=e(11559);function u(t){var i=t.isFollowing,e=t.onSuccess,a=void 0===e?l.ZT:e,s=t.username,u=(0,n.Z)((0,o.useState)(i),2),f=u[0],m=u[1];(0,o.useEffect)(function(){m(i)},[i]);var p=(0,d.E)({apiMethod:c,onSuccess:function(){m(!0),a(!0)}}),x=p.request,g=p.pending,T=(0,d.E)({apiMethod:r,onSuccess:function(){m(!1),a(!1)}}),N=T.request,v=T.pending;return{isFollowing:f,pending:g||v,onFollowStateChangeAction:function(){f?N({username:s}):x({username:s})}}}},4818:function(t,i,e){"use strict";e.d(i,{D:function(){return m}});var n=e(70865),o=e(52322),a=e(64665),s=e(2784),c=e(5632),r={};function l(t){var i=r[t];void 0!==i&&window.scrollTo(0,i)}var d=e(42306),u=e(98324),f=e.n(u);function m(t){var i=t.component,e=t.getAPIMethods,u=t.layoutProps,m=t.isPrivate,p=t.noDefaultLoader,x=t.pageActivatorFeature,g=t.redirectIfLogin,T=t.afterLogin,N=t.disableSSR,v=t.dataProps,h=t.saveScrollPosition,b=void 0!==h&&h,C=function(t){return(!function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],i=(0,c.useRouter)(),e=i.pathname;(0,s.useEffect)(function(){if(t){var n=function(){r[e]=window.scrollY},o=function(){setTimeout(function(){l(e)},0)};i.events.on("routeChangeStart",n),i.events.on("routeChangeComplete",o);var a=setTimeout(function(){l(e)},1e3);return function(){clearTimeout(a),i.events.off("routeChangeStart",n),i.events.off("routeChangeComplete",o)}}},[e,i,t])}(b),(0,d.d)(a.X.LITE_PAGE_ANIMATION))?(0,o.jsx)("div",{className:f().container,children:(0,o.jsx)(i,(0,n.Z)({},t))}):(0,o.jsx)(i,(0,n.Z)({},t))};return C.getAPIMethods=e,C.layoutProps=u,C.isPrivate=m,C.noDefaultLoader=p,C.pageActivatorFeature=x,C.redirectIfLogin=g,C.afterLogin=T,C.disableSSR=N,C.dataProps=v,C.saveScrollPosition=b,C}},18814:function(t){t.exports={NotificationBaseCard__background:"styles_NotificationBaseCard__background__MfBKU"}},19436:function(t){t.exports={NotificationMagnetBaseCard__background:"styles_NotificationMagnetBaseCard__background__ghR1k"}},28219:function(t){t.exports={bg:"styles_bg__hCcOJ"}},42090:function(t){t.exports={transition:"styles_transition__KOxGG",moveUp:"styles_moveUp__2Yvve"}},55917:function(t){t.exports={ProfileNotificationsListCard__iconContainer:"styles_ProfileNotificationsListCard__iconContainer__1rmpg",ProfileNotificationsListCard__notSeenDot:"styles_ProfileNotificationsListCard__notSeenDot__6TmpF"}},33256:function(t){t.exports={"ProfileCard__title--mobileHeader":"styles_ProfileCard__title--mobileHeader__Tpkul"}},98324:function(t){t.exports={container:"styles_container__TOHrJ","fade-out":"styles_fade-out__Z1zNL"}}},function(t){t.O(0,[9774,2888,179],function(){return t(t.s=83514)}),_N_E=t.O()}]);