(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9478],{8044:function(e,t,n){"use strict";n.d(t,{y:function(){return s}});var a=n(45227),r=n(1324),o=n(76778),s=(0,r.q)({url:function(e){var t=e.orderItemId;return"rate-review/order/".concat(t,"/rate-submit/")},type:a.XN.POST,inputTransformer:function(e){var t=e.rate,n=e.problemReasonId;return{rate:(0,o._G)(t),problem:n}}})},90865:function(e,t,n){"use strict";n.d(t,{t:function(){return g}});var a=n(70865),r=n(52322),o=n(96670),s=n(26297),i=n(66383),l=n(2784),c=n(45954),d=n(47842),u=n(74424),m=n(23325),p=n(813),v=n(18936),f=n(52871),x=n(32534),h=n.n(x);function b(e){var t=e.className,n=e.maxFiles,s=e.title,i=e.subTitle,l=e.accept,c=e.children,x=e.hasPreviewItem,b=e.updateFiles,N=e.hasError,j=e.hideButton,g=e.dropZoneBody,_=e.multiple,y=(0,u.uI)({onDrop:function(e){(0,f.xb)(e)||null==b||b(e)},multiple:_,maxFiles:void 0===n?1:n,accept:void 0===l?"image/jpeg, image/png, video/*":l,disabled:!!N}),I=y.getRootProps,T=y.getInputProps,C=y.isDragActive,S=y.isDragReject,Z=(0,v.d)("p-5 bg-neutral-000 rounded border-complete text-center",(0,d.Z)({},h()["UploadBox__dropZone--active-drag"],C),(0,d.Z)({},h()["UploadBox__dropZone--error"],N||S),{"border-complete-200":!C&&!N},h().UploadBox__dropZone,t);return(0,r.jsxs)("div",(0,o.Z)((0,a.Z)({},I({className:Z})),{children:[(0,r.jsx)("input",(0,a.Z)({},T())),g||(0,r.jsxs)("div",{children:[(0,r.jsx)("h6",{className:"text-body-2 text-center text-neutral-700",children:void 0===s?"عکس یا ویدیو خود را جهت بارگذاری داخل کادر بیاندازید.":s}),(0,r.jsx)("p",{className:"text-caption text-center text-neutral-700",children:void 0===i?"حداکثر ۵ تصویر jpeg یا PNG حداکثر یک مگابایت، یک ویدئو MP4 حداکثر ۵۰ مگابایت":i})]}),(0,r.jsxs)("div",{className:"flex justify-evenly items-center mt-4",children:[!(void 0!==j&&j)&&(0,r.jsxs)(p.zx,{type:"button",size:"large",shape:"outlined",color:"primary",children:[(0,r.jsx)(m.J,{icon:"fileTransferUpload",size:22,color:"primary",className:"ml-2"}),"بارگذاری تصویر"]}),void 0!==x&&x&&c]})]}))}var N=n(6277);function j(e){var t=e.className,n=e.errorClassName,d=e.error,u=e.subTitle,m=e.accept,p=e.dropZoneClassName,v=(0,s.Z)(e,["className","errorClassName","error","subTitle","accept","dropZoneClassName"]),f=(0,i.Z)((0,l.useState)([]),2),x=f[0],h=f[1],j=(0,l.useCallback)(function(e){var t=e.map(function(e){return Object.assign(e,{preview:URL.createObjectURL(e)})});h(t),v.upload&&v.upload({files:t})},[h]),g=x.map(function(e){return e.name});return(0,l.useEffect)(function(){return function(){x.forEach(function(e){return URL.revokeObjectURL(e.preview)})}},[x]),(0,r.jsxs)("div",{className:(0,N.Z)(t,"cursor-pointer"),children:[(0,r.jsx)(b,(0,o.Z)((0,a.Z)({updateFiles:j,hasPreviewItem:x.length>0,hasError:!!d,subTitle:u,accept:m,className:p},v),{children:(0,r.jsx)("p",{className:"text-left text-neutral-500 text-body-2",children:g})})),d&&(0,r.jsx)(c.kW,{color:"error",icon:"infoFill",className:n,title:d})]})}function g(e){return(0,r.jsx)(j,(0,a.Z)({},e))}},22025:function(e,t,n){"use strict";n.d(t,{O:function(){return eC}});var a,r=n(47842),o=n(66383),s=n(50930),i=n(52322),l=n(2784),c=n(70865),d=n(98780),u=n(97411),m=n(45227),p=n(1324),v=(0,p.q)({type:m.XN.POST,url:"comments/media/bulk-delete/",inputTransformer:function(e){return{media_ids:e.mediaIds}}}),f=n(64665),x=n(11559),h=n(42306),b=n(41435),N=n(72677),j=n(31909),g=n(61695),_=n(82332),y=n(45859),I=n.n(y);function T(e){var t=e.mediaUrl,n=e.mediaThumbnailUrl,a=e.mediaFileType,r=e.onDelete,o=(0,_.t)(a,g.L.VIDEO),s=(0,h.d)(f.X.ADD_COMMENT_FORM_SINGLE_STEP)||(0,h.d)(f.X.ADD_COMMENT_FORM_MULTIPLE_STEP);return(0,i.jsxs)("div",{className:(0,N.d)({"mr-2 overflow-hidden min-w-24":!s},"rounded relative",{"h-18 w-18":s}),children:[(0,i.jsx)(j.E,{src:n||t,alt:"digikala",width:s?72:96,height:s?72:96,className:"bg-neutral-900 rounded"}),o&&(0,i.jsx)(d.J,{icon:"playSimple",size:s?16:24,color:"white",className:(0,N.d)("absolute rounded-circle",I().AddCommentMediaItem__VideoPlayButton)}),(0,i.jsx)("div",{className:(0,N.d)("p-1 absolute rounded-medium bottom-1 left-1",{"p-2":s},I().AddCommentMediaItem__CTADeleteIcon),children:(0,i.jsx)(d.J,{icon:"delete",size:s?16:24,color:"white",onClick:r})})]})}var C=n(96670),S=n(26297),Z=n(23945),M=n(90865),w=n(64248),E=n(95976),O=(0,p.q)({type:m.XN.POST,url:"media/upload/comments/",options:{timeout:18e4},transformer:function(e){var t;return(0,w.Y)({temporaryMedia:(0,E.w)({data:null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.temporary_media})})},inputTransformer:function(e){var t=e.file,n=new FormData;return n.append("file",t),n}}),k=n(52216);function R(e){var t=e.file,n=e.onSuccess,a=e.onFailed,r=e.className,s=(0,o.Z)((0,l.useState)(0),2),c=s[0],u=s[1],m=(0,x.E)({apiMethod:O,onUploadProgressCallback:function(e){var t=Math.floor(100*e.loaded/e.total);t<=100&&u(t)},onSuccess:function(e){n(null==e?void 0:e.temporaryMedia)},onError:a,requestDataOnLoad:{file:t},fireOnLoad:!!t}).cancelRequest;return(0,i.jsxs)("div",{className:(0,N.d)("relative ml-2 overflow-hidden rounded-medium bg-neutral-900 h-[96px] w-[96px]",r),children:[(0,i.jsxs)("div",{className:(0,N.d)("absolute flex items-center text-neutral-000 left-[15px] top-[15px]"),children:[(0,i.jsx)(d.J,{icon:"fileTransferUpload",color:"white",size:24}),(0,i.jsxs)("p",{className:"mr-2",children:[(0,k.U)(c)," % "]})]}),(0,i.jsx)("div",{className:(0,N.d)("p-2 bg-neutral-000 absolute rounded border bottom-1 left-1"),onClick:m,children:(0,i.jsx)(d.J,{icon:"cancel",size:24})})]})}var U=n(98634);function A(e){var t=e.acceptableFileFormats,n=e.onUploadSuccess,a=e.error,s=e.className,u=e.shouldShrink,m=void 0!==u&&u,p=(0,o.Z)((0,l.useState)({}),2),v=p[0],x=p[1],j=function(){var e=(0,o.Z)(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],1),t=e[0];if(t){var n=(0,U.EL)();x(function(e){return(0,C.Z)((0,c.Z)({},e),(0,r.Z)({},n,t))})}},g=function(e){return function(t){n(t),x(function(t){t[e];var n=(0,S.Z)(t,[e].map(Z.Z));return(0,c.Z)({},n)})}},_=function(e){return function(){x(function(t){t[e];var n=(0,S.Z)(t,[e].map(Z.Z));return(0,c.Z)({},n)})}},y=(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,i.jsx)(d.J,{icon:"cube-file-image-add",color:"black",size:20}),(0,i.jsx)("p",{className:"text-body2-strong mt-1",children:m||!(0,b.x)(v)?"افزودن":"افزودن عکس یا ویدیو"})]});return(0,h.d)(f.X.ADD_COMMENT_FORM_MULTIPLE_STEP)||(0,h.d)(f.X.ADD_COMMENT_FORM_SINGLE_STEP)?(0,i.jsxs)("div",{className:(0,N.d)(s,{"w-full":!m,"flex gap-x-2":!(0,b.x)(Object.entries(v))}),children:[(0,i.jsx)(M.t,{accept:t,updateFiles:j,dropZoneBody:y,dropZoneClassName:(0,N.d)("!border-none bg-neutral-100 !p-4 h-18",{"w-18":m||!(0,b.x)(Object.entries(v))}),hideButton:!0,errorClassName:"absolute whitespace-nowrap",error:a}),Object.entries(v).map(function(e){var t=(0,o.Z)(e,2),n=t[0],a=t[1];return(0,i.jsx)(R,{className:"shrink-0 !h-18 !w-18",file:a,onSuccess:g(n),onFailed:_(n)},n)})]}):(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("div",{className:"relative pb-10",children:(0,i.jsx)(M.t,{title:"افزودن",subTitle:(0,i.jsx)(d.J,{icon:"addCircleOutline",color:"secondary",size:32}),accept:t,updateFiles:j,className:"flex flex-col items-center text-secondary-500 py-4 px-5 rounded-medium cursor-pointer shrink-0 h-[96px] w-[96px]",hideButton:!0,errorClassName:"absolute whitespace-nowrap",error:a})}),Object.entries(v).map(function(e){var t=(0,o.Z)(e,2),n=t[0],a=t[1];return(0,i.jsx)(R,{className:"shrink-0",file:a,onSuccess:g(n),onFailed:_(n)},n)})]})}var z=(0,p.q)({type:m.XN.POST,url:function(e){var t=e.temporaryId;return"comments/".concat(t,"/media/delete/")}}),D=n(24556),P=n.n(D);function F(e){var t,n,a=e.value,o=void 0===a?[]:a,m=e.onChange,p=e.shouldShakeHint,j=e.className,g=e.acceptableFileFormats,_=void 0===g?"image/jpeg, image/png, video/mp4 ,video/x-m4v ,video/x-msvideo":g,y=e.error,I=(0,x.E)({apiMethod:v}).request,C=(0,l.useRef)([]),S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m((0,s.Z)(o||[]).concat([(0,c.Z)({},e)])),C.current=(0,s.Z)(o||[]).concat([e])};(0,l.useEffect)(function(){return function(){(0,b.x)(C.current)||I({mediaIds:C.current.map(function(e){return null==e?void 0:e.mediaTemporaryId}).filter(function(e){return!(0,b.x)(e)})})}},[]);var Z=(0,l.useRef)(null),M=!1,w=(0,x.E)({apiMethod:z}).request,E=(0,l.useCallback)(function(e,t){return function(){var n=null==t?void 0:t.filter(function(t,n){return e!==n}),a=t[e];(null==a?void 0:a.mediaTemporaryId)&&w({temporaryId:null==a?void 0:a.mediaTemporaryId}),m(n)}},[m,w]),O=(0,l.useMemo)(function(){return[(0,i.jsx)(A,{acceptableFileFormats:_,onUploadSuccess:S,error:y},"mediaUpload")].concat((0,s.Z)((o||[]).map(function(e,t,n){return(0,i.jsx)(T,{onDelete:E(t,n),mediaUrl:null==e?void 0:e.mediaUrl,mediaThumbnailUrl:null==e?void 0:e.mediaThumbnailUrl,mediaFileType:null==e?void 0:e.mediaType},null==e?void 0:e.mediaUrl)})))},(0,s.Z)(o||[]).concat([y]));return(0,h.d)(f.X.ADD_COMMENT_FORM_SINGLE_STEP)||(0,h.d)(f.X.ADD_COMMENT_FORM_MULTIPLE_STEP)?(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsxs)("div",{className:(0,N.d)("flex overflow-x-scroll w-full gap-x-2 overflow-y-hidden",j,P().mediaContainer),ref:Z,onMouseDown:function(e){M=!0,t=e.pageX-Z.current.offsetLeft,n=Z.current.scrollLeft},onMouseLeave:function(e){M=!1},onMouseUp:function(e){M=!1},onMouseMove:function(e){if(M){e.preventDefault(),e.stopPropagation();var a=e.pageX-Z.current.offsetLeft;Z.current.scrollLeft=n-(a-t)*3}},children:[(0,i.jsx)(A,{acceptableFileFormats:_,onUploadSuccess:S,error:y,shouldShrink:!(0,b.x)(o)},"mediaUpload"),!(0,b.x)(o)&&o.map(function(e,t,n){return(0,i.jsx)(T,{onDelete:E(t,n),mediaUrl:null==e?void 0:e.mediaUrl,mediaThumbnailUrl:null==e?void 0:e.mediaThumbnailUrl,mediaFileType:null==e?void 0:e.mediaType},null==e?void 0:e.mediaUrl)})]}),(0,i.jsxs)("div",{className:(0,N.d)("mt-2 flex items-center",(0,r.Z)({},P().shakeHint,!!p)),children:[(0,i.jsx)(d.J,{icon:"cube-alert-info-outline",size:16,color:"low-emphasis"}),(0,i.jsx)("span",{className:"text-caption mr-1 text-neutral-400",children:"بسیاری از کاربران در تصمیم‌گیری خود به تصاویر کالای شما نیاز دارند"})]})]}):(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("p",{className:"text-h5 text-neutral-900 lg:mt-5 mt-6",children:"ارسال محتوا"}),(0,i.jsx)("p",{className:"text-body-2 text-neutral-500 mb-4",children:"حداکثر ۵ عکس ۵ مگابایت و ۳ ویدیو با فرمت MP4 تا ۱۰۰ مگابایت"}),(0,i.jsx)("div",{className:(0,N.d)("flex items-center",j),children:(0,i.jsx)(u.l,{className:"min-w-0 grow mr-2",items:O})})]})}var L=n(59437),B=n(57931),q=n(16137),V=n(72610),J=n(65886),H=n(12694),X=n(76778),G=(0,p.q)({type:m.XN.POST,url:function(e){var t=e.productId;return"rate-review/products/".concat(t,"/submit/")},inputTransformer:function(e){var t=e.title,n=e.comment,a=e.advantages,r=e.disAdvantages,o=e.temporaryMediaIds,s=e.oldFilesMediaIds,i=e.isAnonymous,l=e.rating,c=e.recommend,d=e.trueToSize,u=e.orderItemId;return(0,H.s)({order_item_id:u,rating:(0,X._G)(l),title:t,comment:n,advantages:a,disadvantages:r,recommend:c,temporary_media_ids:o,old_file_ids:s,is_anonymous:i,true_to_size_rate:d})}}),Y={RATING:"rating",TRUE_TO_SIZE:"trueToSize",RECOMMEND:"recommend",TITLE:"title",ADVANTAGES:"advantages",DISADVANTAGES:"disadvantages",COMMENT:"comment",TEMPORARY_MEDIA_IDS:"temporaryMediaIds",IS_ANONYMOUS:"isAnonymous"},W=n(46514),Q=[{title:W.Z.tooSmall,value:1},{title:W.Z.small,value:2},{title:W.Z.fit,value:3},{title:W.Z.big,value:4},{title:W.Z.tooBig,value:5}];function K(e){var t=e.option,n=e.className,a=e.isActive,r=e.isFirstOption,o=e.isLastOption,s=e.handleOnClick,l=t.title;return t.value,(0,i.jsx)("div",{className:(0,N.d)(n,"py-4 px-2 text-body-2-compact text-neutral-500 text-wrap border-complete text-center flex items-center flex-1",{"text-body2-strong-compact text-white bg-[#212121] z-1":a,"rounded-r-md":r,"rounded-l-md":o}),onClick:s,children:l})}function $(e){var t=e.className,n=e.options,a=e.value,r=e.onChange,o=function(e){r(e)};return(0,i.jsxs)("div",{className:t,children:[(0,i.jsx)("p",{className:"text-subtitle-strong mb-2",children:"کالای دریافتی کاملا اندازه شما بود؟"}),(0,i.jsx)("div",{className:"flex w-full",children:n.map(function(e,t){var r=e.title,s=e.value;return(0,i.jsx)(K,{option:e,className:"cursor-pointer",isActive:a===s,isFirstOption:0===t,isLastOption:t===n.length-1,handleOnClick:function(){return o(s)}},r)})})]})}var ee=n(72162),et=n(29502),en=n(2334);function ea(e){var t=e.className,n=e.product,a=e.variantInfo,r=e.date,o=e.shouldHideVariant,s=e.isClickDisabled,l=void 0!==s&&s,c=n||{},d=c.productUrl,u=c.productImage,m=c.productTitle,p=a||{},v=p.commentVariantInfoSeller,f=p.commentVariantInfoColor,x=p.commentVariantInfoSize;return(0,i.jsx)("div",{className:(0,N.d)(t,"flex flex-col items-start"),children:(0,i.jsxs)("div",{className:"flex items-start",children:[(0,i.jsx)(L.e,{href:!l&&d,className:"flex flex-col items-start mb-4",children:(0,i.jsx)(j.E,{className:"shrink-0",image:u,alt:m,height:56,width:56})}),(0,i.jsxs)("div",{className:"mr-3",children:[(0,i.jsx)(L.e,{href:!l&&d,children:(0,i.jsx)("p",{className:"text-body1-strong text-neutral-800 ellipsis-1 grow-0",children:m})}),!(void 0!==o&&o)&&(0,i.jsxs)("div",{className:"flex items-center gap-1 text-caption whitespace-nowrap mt-2",children:[(0,i.jsx)(et.e,{seller:v}),(0,i.jsx)(ee.b,{color:f}),(0,i.jsx)(en.N,{size:x}),(0,i.jsx)("p",{className:"text-neutral-500",children:(0,k.U)(r)})]})]})]})})}var er=n(8044),eo=n(59731);function es(e){var t=e.className,n=e.value,a=e.onChange,r=e.orderItemId,o=(0,x.E)({apiMethod:er.y}).request;return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"text-subtitle-strong",children:[(0,i.jsxs)("span",{children:[" ",n?"امتیاز ثبت شده:":"امتیاز دهید!"]}),(0,i.jsx)("span",{className:"text-primary-500",children:"*"})]}),(0,i.jsx)(eo.a,{shouldShowRateNumber:!0,className:(0,N.d)(t,"gap-x-6"),rate:n,onSetRate:function(e,t){o({rate:e,orderItemId:r,problemReasonId:t}).then(function(){null==a||a(e)})}})]})}var ei=n(15644),el=n(21494);function ec(e){var t=e.items;e.className;var n=(0,o.Z)((0,l.useState)(0),2),a=n[0],r=n[1];return((0,l.useEffect)(function(){if(t.length>1){var e=setInterval(function(){r(function(e){return(e+1)%t.length})},3e3);return function(){clearInterval(e)}}},[t.length]),(0,l.useEffect)(function(){if(a===t.length-1&&t.length>1){var e=setTimeout(function(){r(0)},3e3);return function(){clearTimeout(e)}}},[a,t.length]),(0,b.x)(t))?null:(0,i.jsx)("div",{className:"overflow-hidden mb-3 h-5 lg:mt-0",children:(0,i.jsx)("div",{style:{transform:"translateY(".concat(-20*a,"px)"),transitionDuration:"".concat(0===a?"0s":"".concat(300,"ms"))},children:t.map(function(e,t){return(0,i.jsx)("div",{children:e})})})})}var ed=n(24960),eu=n.n(ed),em=(0,l.forwardRef)(function(e,t){var n=e.className,a=e.openSelectCommentType,r=e.username,s=e.isAnonymous,c=e.suggestedQuestions,u=e.name,m=e.error,p=e.value,v=e.onChange,f=e.onTextChange,x=(0,o.Z)((0,l.useState)(!1),2),h=x[0],j=x[1],g=(0,o.Z)((0,l.useState)(!1),2),_=g[0],y=g[1],I=(0,l.useMemo)(function(){var e=null==c?void 0:c.map(function(e,t){return(0,i.jsx)("div",{className:"text-body-2 h-5",children:e})});return(null==e?void 0:e.length)>1&&(null==e||e.push((0,i.jsx)("div",{className:"text-body-2 h-5",children:c[0]}))),e},[c]),T=function(e){(null==e?void 0:e.length)>=3?(j(!0),y(!1),(null==e?void 0:e.length)>120&&y(!0)):j(!1)};(0,l.useEffect)(function(){T(p)},[]);var C={name:s?"کاربر دیجی‌کالا":r,buttonTp:s?"ارسال ناشناس":"ارسال با نام شما"};return(0,i.jsxs)("div",{className:(0,N.d)(n),children:[(0,i.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,i.jsx)("span",{className:(0,N.d)("text-subtitle-strong",eu().required_badge),children:"متن دیدگاه:"}),h&&(0,i.jsx)(ei.A,{activeColor:"success",isActive:!0,size:"small",radiusSize:"medium",className:(0,N.d)({"bg-app-background-mid-dark text-neutral-650":_},"text-caption-strong !border-none"),children:_?"ممنون که دیدگاه مفیدی برای کاربران می‌نویسی":"پیشنهاد می‌کنیم دیدگاهت رو کامل‌تر کنی"})]}),(0,i.jsx)(el.I,{ref:t,isTextarea:!0,fullWidth:!0,backgroundColor:"color-app-background",inputWrapperClassName:"!rounded-none !rounded-t-md !border-b-neutral-200 !border-l-neutral-300 !border-t-neutral-300 !border-r-neutral-300",inputClassName:"caret-black h-29",placeholder:"نظر خود را در مورد این کالا با کاربران دیگر به اشتراک بگذارید..",name:u,error:m,value:p,onChange:function(e){var t=e.target.value;T(t),f(t),v(e)}}),(0,i.jsxs)("div",{className:"border-complete !border-t-0 !border-l-neutral-300 !border-b-neutral-300 !border-r-neutral-300 p-2 items-center rounded-b-md flex justify-between mb-2",children:[(0,i.jsx)("span",{className:"text-body2-strong text-neutral-650 truncate",children:C.name}),(0,i.jsxs)("div",{className:"flex items-center bg-app-background-mid-dark text-neutral-650 px-3 py-1 rounded-lg cursor-pointer",onClick:a,children:[(0,i.jsx)("span",{className:"text-body-2 ml-1 whitespace-nowrap",children:C.buttonTp}),(0,i.jsx)(d.J,{icon:"cube-nav-chevron-down",size:18})]})]}),!(0,b.x)(c)&&(0,i.jsxs)("div",{className:"flex overflow-hidden h-5 items-center",children:[(0,i.jsx)(d.J,{icon:"cube-action-ai-all",color:"ai",className:"ml-1",size:20}),(0,i.jsx)("div",{className:"overflow-hidden h-5 flex",children:I.length>1?(0,i.jsx)(ec,{items:I}):I[0]})]})]})}),ep=n(50603),ev=n(58809);function ef(e){var t=e.isModalOpen,n=e.closeModal,a=e.isAnonymous,r=e.username,o=e.onChange,s=(0,l.useMemo)(function(){return[{name:"isAnonymous",label:"ارسال ناشناس",caption:(0,i.jsx)("div",{className:"text-caption text-neutral-600",children:"دیدگاه شما در صفحه محصول با عنوان کاربر دیجی‌کالا نمایش داده می‌شود"}),checked:a,value:"anonymous"},{name:"personal_name",label:"ارسال با نام شما",caption:(0,i.jsxs)("div",{className:"text-caption text-neutral-600",children:["دیدگاه شما در صفحه محصول با نام"," ",(0,i.jsx)("span",{className:"text-caption-strong",children:r})," نمایش داده می‌شود"]}),checked:!a,value:"known"}]},[a]);return(0,i.jsx)(ep.Modal,{isOpen:t,headerTitle:"نحوه نمایش دیدگاه‌ها",onDismiss:n,children:s.map(function(e){return(0,i.jsx)("div",{children:(0,i.jsx)(ev.Y,{name:e.name,label:e.label,checked:e.checked,description:e.caption,labelClassName:"text-body1-strong text-neutral-900",value:e.value,onChange:o})})})})}var ex=n(26442),eh=n(57874),eb=n(90247),eN=n(80803),ej=n(87049),eg=n(6013),e_=n(75490),ey=n(52536),eI={1:eh.U.tooSmall,2:eh.U.small,3:eh.U.fit,4:eh.U.big,5:eh.U.tooBig},eT=(a={},(0,r.Z)(a,eh.U.tooSmall,1),(0,r.Z)(a,eh.U.small,2),(0,r.Z)(a,eh.U.fit,3),(0,r.Z)(a,eh.U.big,4),(0,r.Z)(a,eh.U.tooBig,5),a);function eC(e){var t=e.productId,n=e.pending,a=e.addCommentData,r=e.hasThankYouStep,c=void 0!==r&&r,d=e.showThankYouStep,u=e.className,m=e.buttonClassName,p=e.onSuccess,v=e.onSetRate,f=e.rate,h=(0,eN.d)(),b=h.isOpen,j=h.onOpen,g=h.onClose,y=(0,x.E)({apiMethod:G,onSuccess:function(e){c?null==d||d():(0,e_.p)({message:"نظر شما ثبت گردید و پس از تایید، نمایش داده خواهد شد"}),null==p||p(e)}}).request,I=(0,ej.v)(null===eg.p||void 0===eg.p?void 0:eg.p.userInfo),T=(0,eb.c)().ref,C=(0,l.useRef)(),S=(0,l.useRef)(),Z=(0,o.Z)((0,l.useState)(null),2),M=Z[0],w=Z[1],E=(0,o.Z)((0,l.useState)(!0),2),O=E[0],k=E[1],R=function(e){k((null==e?void 0:e.length)<3)},U=function(){var e;S.current.style.paddingBottom="".concat(null===(e=C.current)||void 0===e?void 0:e.clientHeight,"px")},A=a||{},z=A.product,D=A.hasTrueToSize,P=A.variantInfo,H=A.createdAt,X=A.comment,W=A.userIsbuyer,K=A.suggestedQuestions,ee=A.orderItemId,et=X||{},en=et.commentBody,er=et.commentIsAnonymous,eo=et.commentFiles,ei=et.commentRate,el=et.commentTrueToSizeRate;(0,l.useEffect)(function(){setTimeout(function(){null==M||M.focus()},800)},[M]);var ec=(0,o.Z)((0,l.useState)(!1),2),ed=ec[0],eu=ec[1],ep=(0,l.useCallback)(function(){eu(!0),setTimeout(function(){eu(!1)},500)},[eu]);(0,l.useEffect)(function(){return null==M||M.addEventListener("blur",ep),function(){return null==M?void 0:M.removeEventListener("blur",ep)}},[M]);var ev=(0,o.Z)((0,l.useState)(er),2),eh=ev[0],eC=ev[1];(0,l.useEffect)(function(){eC(er)},[er]);var eS=(0,o.Z)((0,l.useState)(f||ei),2),eZ=eS[0],eM=eS[1];(0,l.useEffect)(function(){f&&eM(f||ei)},[f]);var ew=(0,l.useMemo)(function(){return[{component:(0,i.jsx)("div",{className:"border-complete-b"})},{component:(0,i.jsx)($,{options:Q,className:"mb-8 mt-5"}),name:Y.TRUE_TO_SIZE,disabled:!W||!D},{component:(0,i.jsx)(em,{className:"my-5",openSelectCommentType:j,username:null==I?void 0:I.userName,isAnonymous:eh,suggestedQuestions:K,onTextChange:R,ref:function(e){w(e)}}),name:Y.COMMENT},{component:(0,i.jsx)(F,{shouldShakeHint:ed}),name:Y.TEMPORARY_MEDIA_IDS,rules:{validate:ey.zK},disabled:!W},{component:(0,i.jsx)(J.x,{handleHeight:!0,onResize:U,children:(0,i.jsxs)("div",{className:(0,N.d)("w-full z-1 bg-neutral-000 px-5 py-4 bottom-0 shadow-1-top",m),ref:C,children:[(0,i.jsx)(B.z,{size:"large",className:"w-full mb-2",type:"submit",disabled:O,children:W?"ثبت امتیاز و دیدگاه":"ثبت دیدگاه"}),(0,i.jsxs)("p",{className:"text-caption text-center",children:["ثبت دیدگاه به معنی موافقت با",(0,i.jsx)(L.e,{className:"mx-1 text-secondary-500",href:ex.m,target:"_blank",children:"قوانین انتشار دیجی‌کالا"}),"است."]})]})})}].reduce(function(e,t){return t.disabled?e:(0,s.Z)(e).concat([t])},[])},[eh,er,en,eo,D,ed,O]);return void 0!==n&&n?(0,i.jsx)(V.g,{className:"my-20"}):(0,i.jsxs)("div",{className:u,children:[(0,i.jsxs)("div",{className:"p-4",ref:S,children:[(0,i.jsx)(ea,{product:z,variantInfo:P,date:H,shouldHideVariant:!W,isClickDisabled:!0}),W&&(0,i.jsx)(es,{onChange:function(e){null==v||v(e),eM(e)},value:eZ,orderItemId:ee,className:"mt-4 mb-5"}),(0,i.jsx)(q.l,{ref:T,useFormProps:{mode:"onChange",defaultValues:{comment:en,temporaryMediaIds:eo,trueToSize:eT[el]}},items:ew,onSubmit:function(e){var n,a;return y({orderItemId:ee||null,comment:e.comment,temporaryMediaIds:null===(n=e.temporaryMediaIds)||void 0===n?void 0:n.map(function(e){return null==e?void 0:e.mediaTemporaryId}).filter(Boolean),oldFilesMediaIds:null===(a=e.temporaryMediaIds)||void 0===a?void 0:a.map(function(e){var t;return(null==e?void 0:e.mediaTemporaryId)?void 0:null==e?void 0:null===(t=e.mediaStorageIds)||void 0===t?void 0:t[0]}).filter(Boolean),isAnonymous:eh,rating:eZ,trueToSize:D&&W?eI[+e.trueToSize]:void 0,productId:t})}})]}),(0,i.jsx)(ef,{isModalOpen:b,closeModal:g,onChange:function(e){eC((0,_.t)(e.target.value,"anonymous"))},username:null==I?void 0:I.userName,isAnonymous:eh})]})}},21556:function(e,t,n){"use strict";n.d(t,{q:function(){return i}});var a=n(1249),r=n(28141),o=n(8398),s=n(73587),i=(0,n(1324).q)({url:function(e){var t=e.productId,n=e.orderItemId,a=e.isEdit?1:0,r=n?"?orderItemId=".concat(n,"&edit=").concat(a):"?edit=".concat(a);return"rate-review/products/".concat(t,"/check/").concat(r)},transformer:function(e){var t=e.data||{},n=t.review,o=t.is_buyer,i=t.has_true_to_size,l=t.variant_info,c=t.product,d=t.order_item_id,u=t.created_at,m=t.suggested_questions;return{comment:(0,a.T)({data:n}),userIsbuyer:!!o,hasTrueToSize:i,product:(0,s.r)({data:c}),orderItemId:d,createdAt:u,variantInfo:(0,r.t)({data:l}),suggestedQuestions:m}},inputTransformer:o.d,disableGlobalSearchParams:!0})},52358:function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var a=n(52322),r=n(58809),o=n(72677);function s(e){var t=e.transactionProblemReasons,n=e.onChange,s=e.value,i=e.name,l=e.className,c=t||{},d=c.transactionProblemReasonId,u=c.transactionProblemReasonLabel;return(0,a.jsxs)("label",{className:(0,o.d)("flex items-center mt-1 p-2",l),children:[(0,a.jsx)(r.Y,{checked:s==d,onChange:function(){return n({target:{value:d,name:i}})}}),(0,a.jsx)("p",{className:"text-body-1 text-neutral-700 mr-4",children:u})]})}function i(e){var t=e.itemClassName,n=e.transactionProblemReasons,r=e.onChange,o=e.value,i=e.name,l=e.hideTitle;return(0,a.jsxs)(a.Fragment,{children:[!l&&(0,a.jsx)("p",{className:"text-neutral-700 text-body-1 mb-1",children:"لطفا دلیل نارضایتی خود رامشخص کنید:"}),null==n?void 0:n.map(function(e){return(0,a.jsx)(s,{transactionProblemReasons:e,onChange:r,value:o,name:i,className:t},e.transactionProblemReasonId)})]})}},59731:function(e,t,n){"use strict";n.d(t,{a:function(){return b}});var a=n(66383),r=n(52322),o=n(2784),s=n(17156),i=n(98780),l=n(72610),c=n(50603),d=n(52358),u=(0,n(1324).q)({url:"/rate-review/problem-reasons/",transformer:function(e){var t=(e.data||{}).problem_reasons;return{problemReasons:Object.keys(t||{}).map(function(e){var n,a;return{transactionProblemReason:null===(n=t[e])||void 0===n?void 0:n.problem,transactionProblemReasonId:e,transactionProblemReasonLabel:null===(a=t[e])||void 0===a?void 0:a.title}})}}}),m=n(72873);function p(e){var t=e.isOpen,n=e.onClose,a=e.onChange,o=e.value,s=(0,m.V)({apiMethod:u,disabled:!t}),i=s.data,p=s.pending,v=(i||{}).problemReasons;return(0,r.jsx)(c.Modal,{isOpen:t,onDismiss:n,headerTitle:"چرا راضی نبودید؟",headerDescription:"لطفاً دلیل نارضایتی خود را انتخاب کنید تا خدمات بهتری ارائه دهیم.",children:p||!t?(0,r.jsx)(l.g,{className:"my-20"}):(0,r.jsx)(d.d,{itemClassName:"!p-0",transactionProblemReasons:v,onChange:a,value:o,hideTitle:!0})})}var v=n(35239),f=n(80803),x=n(52216),h=n(72677);function b(e){var t=e.className,n=e.rate,l=e.onSetRate,c=e.shouldShowRateNumber,d=e.classNameRateNumber,u=void 0===d?"text-body1-strong mt-2 text-neutral-700":d,m=e.size,b=void 0===m?24:m,N=e.disableProblemReason,j=(0,s.cC)(v.U.LOW_RATE_REASON),g=(0,f.d)(),_=g.isOpen,y=g.onOpen,I=g.onClose,T=(0,a.Z)((0,o.useState)(void 0),2),C=T[0],S=T[1],Z=(0,o.useRef)();return(0,r.jsxs)("div",{className:(0,h.d)(t,"flex"),children:[(0,r.jsx)(p,{isOpen:_,onClose:I,onChange:function(e){var t=Number(e.target.value);S(t),setTimeout(function(){l(Z.current,t),I()},200)},value:C}),Array.from({length:5},function(e,t){var a=n>t,o=t+1;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)(i.J,{onClick:function(){if(N||!j){l(o,null);return}n>2&&o<=2||!n&&o<=2?(S(void 0),y(),Z.current=o):l(o,null)},icon:a?"starFill":"starOutline",color:a?"warning":"low-emphasis",size:b}),c&&(0,r.jsx)("p",{className:u,children:(0,x.U)(o)})]})})})]})}},72162:function(e,t,n){"use strict";n.d(t,{b:function(){return l}});var a=n(52322),r=n(98780),o=n(72677),s=n(10863),i=n.n(s);function l(e){var t=e.className,n=e.color||{},s=n.colorTitle,l=n.colorHexCode;return s?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:(0,o.d)(t,"ml-2 inline-block rounded-circle",i().OrderItemColor),style:{backgroundColor:l}}),(0,a.jsx)("p",{className:"text-neutral-500 inline",children:s}),(0,a.jsx)(r.J,{icon:"dot",color:"low-emphasis",size:16})]}):null}},29502:function(e,t,n){"use strict";n.d(t,{e:function(){return s}});var a=n(52322),r=n(98780),o=n(98723);function s(e){var t=e.seller||{},n=t.sellerTitle,s=t.sellerUrl;return n?(0,a.jsxs)(o.r,{className:"flex items-center",target:"_blank",to:s,children:[(0,a.jsx)(r.J,{icon:"seller",size:18,className:"text-neutral-700 ml-2"}),(0,a.jsx)("p",{className:"text-neutral-500",children:n}),(0,a.jsx)(r.J,{icon:"dot",color:"low-emphasis",size:16})]}):null}},2334:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var a=n(52322),r=n(98780);function o(e){var t=(e.size||{}).sizeTitle;return t?(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(r.J,{icon:"variationSize",size:18}),(0,a.jsx)("p",{className:"text-neutral-500 inline mr-1",children:t}),(0,a.jsx)(r.J,{icon:"dot",color:"low-emphasis",size:16})]}):null}},28141:function(e,t,n){"use strict";n.d(t,{t:function(){return s}});var a=n(52126),r=n(82382),o=n(63431);function s(e){var t=e.data||{},n=t.seller,s=t.size,i=t.color;return{commentVariantInfoSeller:(0,r.N)({data:n}),commentVariantInfoColor:(0,a.n)({data:i}),commentVariantInfoSize:(0,o.E)({data:s})}}},1249:function(e,t,n){"use strict";n.d(t,{T:function(){return u}});var a=n(70865),r=n(96670),o=n(52126),s=n(95976),i=n(73587),l=n(96992),c=n(82382),d=n(63431);function u(e){var t,n,u=e.data||{},m=u.id,p=u.is_anonymous,v=u.title,f=u.body,x=u.created_at,h=u.relative_date,b=u.rate,N=u.reactions,j=u.files,g=u.status,_=u.recommendation_status,y=u.is_buyer,I=u.user_name,T=u.user_reactions,C=u.purchased_item,S=u.advantages,Z=u.disadvantages,M=u.rates,w=u.true_to_size_rate,E=u.product,O=u.order_item_id,k=N||{},R=k.likes,U=k.dislikes,A=C||{},z=A.seller,D=A.color,P=A.size,F=(0,c.N)({prefix:"commentPurchasedItem",data:z}),L=(0,c.N)({data:z}),B=(0,o.n)({prefix:"commentPurchasedItem",data:D}),q=(0,o.n)({data:D}),V=P?(0,d.E)({prefix:"commentPurchasedItem",data:P}):{},J=(0,d.E)({data:P}),H=(0,i.r)({prefix:"comment",data:E}),X=(0,i.r)({data:E}),G=(null==j?void 0:j.map(function(e){return(0,s.w)({data:e})}))||[],Y=(0,l.l)({data:null==b?void 0:null===(t=b.toFixed)||void 0===t?void 0:t.call(b,1)});return(0,r.Z)((0,a.Z)((0,r.Z)((0,a.Z)((0,r.Z)((0,a.Z)((0,r.Z)((0,a.Z)({commentId:m,commentIsAnonymous:!!p,commentTitle:v,commentBody:f,commentCreatedAt:x,commentRelativeDate:h,commentRating:Y,commentRate:null==b?void 0:null===(n=b.toFixed)||void 0===n?void 0:n.call(b,1),commentReactions:{likes:R,dislikes:U},commentOrderItemId:O,commentReactionsLikes:R,commentReactionsDislikes:U,commentFiles:G,commentStatus:g,commentRecommendationStatus:_,commentTrueToSizeRate:w,commentIsBuyer:!!y,commentUserName:I,commentUserReactions:T},F),{commentItemSeller:L}),B),{commentItemColor:q}),V),{commentItemSize:J,commentAdvantages:S,commentDisadvantages:Z,commentRates:M}),H),{commentProduct:X})}},95976:function(e,t,n){"use strict";n.d(t,{w:function(){return r}});var a=n(61695);function r(e){var t=e.data||{},n=t.storage_ids,r=t.url,o=t.temporary_id,s=t.thumbnail_url;return{mediaStorageIds:n||[],mediaUrl:null==r?void 0:r[0],mediaTemporaryId:o,mediaThumbnailUrl:(null==s?void 0:s[0])||"",mediaType:function(e){var t,n,r,o;if(!e)return a.L.UNKNOWN;switch(null===(t=/(\w+)\.([1-9A-Za-z]{3,4})(?=\?|$)/.exec(e))||void 0===t?void 0:null===(n=t.slice)||void 0===n?void 0:null===(r=n.call(t,-1))||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:o.toLowerCase()){case"jpg":case"jpeg":case"svg":case"png":return a.L.IMAGE;case"mp4":case"mkv":case"webm":return a.L.VIDEO;default:return a.L.UNKNOWN}}(null==r?void 0:r[0])}}},45859:function(e){e.exports={AddCommentMediaItem__CTADeleteIcon:"styles_AddCommentMediaItem__CTADeleteIcon__Olpt8",AddCommentMediaItem__VideoPlayButton:"styles_AddCommentMediaItem__VideoPlayButton__wH5ZZ"}},24556:function(e){e.exports={mediaContainer:"styles_mediaContainer__zU75r",shakeHint:"styles_shakeHint__Vxleh",shakeHintAnimation:"styles_shakeHintAnimation__0NMjC"}},24960:function(e){e.exports={required_badge:"styles_required_badge__zrGFx"}},10863:function(e){e.exports={OrderItemColor:"styles_OrderItemColor__T8oc3"}},32534:function(e){e.exports={UploadBox__dropZone:"styles_UploadBox__dropZone__jrLQi","UploadBox__dropZone--active-drag":"styles_UploadBox__dropZone--active-drag__fNEJa","UploadBox__dropZone--error":"styles_UploadBox__dropZone--error___tMNb"}}}]);